{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Components{% endblock %}</h1>
{% endblock %}

{% block script %}
  <script>
    function copyToClipBoard(item) {
      if(navigator.clipboard){
        navigator.clipboard.writeText(item);
        alert("Copied!");
      }
    }
  </script>
{% endblock %}

{% block content %}
  {% if components %}
    <h2>Installed components:</h2>
    <ul>
      {% for component in components %}
        <li title="{{ component }}">
          <form method="post" action="/components/remove">
            <input type="hidden" name="cname" value="{{ component.name }}" />
            <input type="submit" value="Ã—" class="err">
          </form>
          <form method="post" action="/components/add">
            <input type="hidden" name="cname" value="{{ component.name }} 2" />
            <input type="hidden" name="curl" value="{{ component.pull_url }}" />
            <input type="hidden" name="crun" value="{{ component.run }}" />
            <input type="submit" value="duplicate">
          </form>
          <button title="copy to clipboard" onclick='copyToClipBoard("{{ component }}")'><img class="icon" alt="copy to clipboard" src="{{ url_for('static', filename='icons/clipboard-regular.svg') }}" /></button>
          {{ component.name }}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <h2>No components installed according to component manifest</h2>
  {% endif %}
  <details>
      <summary>Add a component</summary>
      <form method="post" action="/components/add">
          <label for="cname">Component name:</label>
          <input name="cname" id="cname" required>
          <br />
          <label for="curl">Component pull url:</label>
          <input name="curl" id="curl" required>
          <br />
          <label for="crun">Component run commands:</label>
          <input name="crun" id="crun" required>
          <br />
          <input type="submit" value="Add component">
      </form>
  </details>
  <button>Upgrade Components</button>
{% endblock %}

{% block style %}
  <style>
    form {
      display: inline;
    }
  </style>
{% endblock %}